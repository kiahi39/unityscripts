
<!-- console $ pug -w ./ -o ./ -P--><!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>もちメニュー</title>
    <meta name="description">
    <meta name="keywords">
    <link rel="stylesheet" href="./layout.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
  </head>
  <body>
    <div id="mochi_menu">
      <div class="menu-icon-layer menu-size-wrapper">
        <div class="menu-block">
          <div v-for="(item, index) in menu_items" style="position:relative;" v-bind:class="`position-${index+1}`">
            <div class="click-box" v-on:click="menu_click(index+1)"></div><i class="menu-icon" v-bind:class="item.classname"></i>
          </div>
        </div>
      </div>
      <div class="menu-size-wrapper" id="blob-loader">
        <div class="menu-rect" v-bind:class="{'anime_swell': click_flash}"></div>
        <div class="menu-block">
          <div class="mochi" v-bind:class="[position_class, {'anime_drop': click_flash}]"></div>
        </div>
      </div>
      <svg xmins="http://www.w3.org/2000/svg" version="1.1">
        <defs> 
          <filter id="blob">
            <fegaussianblur in="SourceGraphic" result="blur" stdDeviation="8"></fegaussianblur>
            <fecolormatrix in="blur" result="blob" mode="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 40 -10"></fecolormatrix>
          </filter>
        </defs>
      </svg>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
      const mochi_menu = new Vue({
          el: '#mochi_menu',
          data: {
              menu_items : [
                  {
                      classname: {"fas fa-home": true}
                  },
                  {
                      classname: {"far fa-bell": true}
                  },
                  {    
                      classname: {"far fa-bookmark": true}
                  }
              ],
              active_menu: 1,
              click_flash: false,
              on_animation: false,
              anime_reqired_time: 1000
          },
          created: function (n) {
              console.log("created.");
          },
          methods: {
              menu_click: function (n) {
                  if(this.on_animation) {
                      return;
                  }
                  this.start_click_flash();
                  this.start_anime_timer();
                  this.active_menu = n;
                  console.log("[active_menu] = ",this.active_menu);
              },
              start_click_flash: function () {
                  this.click_flash = false;
                  setTimeout(
                      ()=>{ this.click_flash = true;},
                      1
                  );
                  
              },
              start_anime_timer: function () {
                  this.on_animation = true;
                  setTimeout(
                      ()=>{ 
                          this.on_animation = false;
                          console.log("stop anime timer");
                      },
                      this.anime_reqired_time
                  );
                  console.log("start anime timer");
              }
          },
          computed: {
              position_class: function() {
                  let array = [];
                  for (let i=1; i<=this.menu_items.length; i++ ){
                      if(this.active_menu == i){
                          array.push(`position-${i}`);
                      }
                  }
                  return array;
              }
          },
      
      })
    </script>
  </body>
</html>